@page "/Account/Register"

@using System.ComponentModel.DataAnnotations
@using System.Text
@using System.Text.Encodings.Web
@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.WebUtilities
@using ReMindHealth.Data

@inject UserManager<ApplicationUser> UserManager
@inject SignInManager<ApplicationUser> SignInManager
@inject ILogger<Register> Logger
@inject NavigationManager NavigationManager

<PageTitle>Registrieren</PageTitle>

<div class="auth-container">
    <div class="auth-card">
        <h1>Konto erstellen</h1>
        <p class="subtitle">Willkommen bei ReMind Health!</p>

        @if (!string.IsNullOrEmpty(errorMessage))
        {
            <div class="alert alert-danger">
                @errorMessage
            </div>
        }

        @if (!string.IsNullOrEmpty(successMessage))
        {
            <div class="alert alert-success">
                @successMessage
            </div>
        }

        <EditForm Model="Input" OnValidSubmit="RegisterUser" FormName="register">
            <DataAnnotationsValidator />
            <ValidationSummary class="text-danger" role="alert" />

            <div class="form-group">
                <label for="email">E-Mail</label>
                <InputText @bind-Value="Input.Email" class="form-control" autocomplete="username" placeholder="name@example.com" />
                <ValidationMessage For="() => Input.Email" class="text-danger" />
            </div>

            <div class="form-group">
                <label for="password">Passwort</label>
                <InputText type="password" @bind-Value="Input.Password" class="form-control" autocomplete="new-password" placeholder="Mindestens 6 Zeichen" />
                <ValidationMessage For="() => Input.Password" class="text-danger" />
            </div>

            <div class="form-group">
                <label for="confirm-password">Passwort bestätigen</label>
                <InputText type="password" @bind-Value="Input.ConfirmPassword" class="form-control" autocomplete="new-password" placeholder="Passwort wiederholen" />
                <ValidationMessage For="() => Input.ConfirmPassword" class="text-danger" />
            </div>

            <button type="submit" class="btn-submit" disabled="@isSubmitting">
                @if (isSubmitting)
                {
                    <span>Wird erstellt...</span>
                }
                else
                {
                    <span>Registrieren</span>
                }
            </button>
        </EditForm>

        <div class="auth-footer">
            <p>
                Bereits registriert?
                <a href="/Account/Login">Jetzt anmelden</a>
            </p>
        </div>
    </div>
</div>

